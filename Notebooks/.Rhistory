getwd()
dir()
dir("./Functions")
## Librerías
# Datos
library(readxl)
library(tidyr)
library(dplyr)
library(googlesheets4)
library(stringr)
# Análsis de datos
library(likert)
library(nortest)
library(effsize)
library(psychometric)
library(ShinyItemAnalysis)
#Graficas
library(ggplot2)
library(gt)
library(DT)
#Funciones propias
source("./Functions/min_max_scaler.R")
# Otros
options(digits=5, scipen = 50)
set.seed(321)
dir("..")
dir("../Pdf")
dir("../Pdf")
dir("../Pdf/")
dir("..")
dir("../Data")
dir("../Pdf")
## Librerías
# Datos
library(readxl)
library(tidyr)
library(dplyr)
library(googlesheets4)
library(stringr)
# Análsis de datos
library(likert)
library(nortest)
library(effsize)
library(psychometric)
library(ShinyItemAnalysis)
#Graficas
library(ggplot2)
library(gt)
library(DT)
#Funciones propias
source("./Functions/min_max_scaler.R")
# Otros
options(digits=5, scipen = 50)
set.seed(321)
rmarkdown::render(output_file = "../Pdf/Resultados primera aplicacion.pdf")
rmarkdown::render(output_file = "../Pdf/Resultados primera aplicacion.pdf")
rmarkdown::render(input="1.0-bapinedam-Primera_aplicacion.Rmd",output_file = "../Pdf/Resultados primera aplicacion.pdf")
# Data
### Autenticación de usuario
gs4_auth()
# pre
### Obtención de los datos
url_pre = "https://docs.google.com/spreadsheets/d/1Ry73ckzruTQxtDnkCSscs16M3cv3u9XgJlcg4sN94BE/edit?usp=sharing"
sheet_names(url_pre)
# post
url_post = "https://docs.google.com/spreadsheets/d/1tFkxbH5N9HMr5qRA-VF4JXh-MAJqW38-iidB4QBuKU4/edit#gid=1877736074"
sheet_names(url_post)
source("./Functions/calificacion.R")
rmarkdown::render(input="1.0-bapinedam-Primera_aplicacion.Rmd",output_file = "../Pdf/Resultados primera aplicacion.pdf")
rmarkdown::render(input="1.0-bapinedam-Primera_aplicacion.Rmd",output_file = "../Pdf/Resultados primera aplicacion.pdf")
# Pre
actitudes_pre = read_sheet(url_pre, sheet = "Actitudes")
actitudes_pre = actitudes_pre[,1:15]
col_items = paste(rep("Grupo", 9), rep(1:3, each = 3), rep(paste("_", rep(1:3, 3))))
vector = c(colnames(actitudes_pre)[1:6], col_items)
colnames(actitudes_pre) = vector
actitudes_pre = filter(actitudes_pre,
!is.na(`Código`),
!is.na(`Grupo 1 _ 1`),
`Grupo 1 _ 1` %in% c("A", "B", "O", "X"))
dim(actitudes_pre)
actitudes_pre[,7:15] = apply(actitudes_pre[,7:15], 2, function(x) str_to_upper(x))
actitudes_pre[,7:15] = apply(actitudes_pre[,7:15], 2, function(x) {ifelse(x == "B", 1, 0)})
actitudes_post = read_sheet(url_post, sheet = "Actitudes")
actitudes_post = actitudes_post[,1:15]
col_items = paste(rep("Grupo", 9), rep(1:3, each = 3), rep(paste("_", rep(1:3, 3))))
vector = c(colnames(actitudes_post)[1:6], col_items)
colnames(actitudes_post) = vector
actitudes_post[,7:15] = apply(actitudes_post[,7:15], 2, function(x) as.character(x))
actitudes_post = filter(actitudes_post,
!is.na(`Código`),
!is.na(`Grupo 1 _ 1`),
`Grupo 1 _ 1` %in% c("A", "B", "O", "X"))
dim(actitudes_post)
actitudes_post[,7:15] = apply(actitudes_post[,7:15], 2, function(x) str_to_upper(x))
claves_matematicas =  c('B',	'A',	'A',	'A',	'A',	'B',	'A',	'A',	'B') # Vector con claves de matemáticas
claves_lenguaje = c('A',	'A',	'B',	'B',	'A',	'A',	'A',	'B',	'A') # Vector con claves de lenguaje
actitudes_lenguaje_pre = filter(actitudes_pre, substr(`Código`, 1, 1) == "1")
actitudes_lenguaje_post = filter(actitudes_post, substr(`Código`, 1, 1) == "1")
# Calificación
# Total
actitudes_lenguaje_pre$Total_pre = apply(actitudes_lenguaje_pre[,7:15], 1, function(x) sum(x, na.rm= FALSE))
actitudes_lenguaje_post$Total_post = apply(actitudes_lenguaje_post[,7:15], 1, function(x) sum(x, na.rm= FALSE))
View(actitudes_lenguaje_post)
actitudes_post = read_sheet(url_post, sheet = "Actitudes")
actitudes_post = actitudes_post[,1:15]
col_items = paste(rep("Grupo", 9), rep(1:3, each = 3), rep(paste("_", rep(1:3, 3))))
vector = c(colnames(actitudes_post)[1:6], col_items)
colnames(actitudes_post) = vector
actitudes_post[,7:15] = apply(actitudes_post[,7:15], 2, function(x) as.character(x))
actitudes_post = filter(actitudes_post,
!is.na(`Código`),
!is.na(`Grupo 1 _ 1`),
`Grupo 1 _ 1` %in% c("A", "B", "O", "X"))
dim(actitudes_post)
actitudes_post[,7:15] = apply(actitudes_post[,7:15], 2, function(x) str_to_upper(x))
claves_matematicas =  c('B',	'A',	'A',	'A',	'A',	'B',	'A',	'A',	'B') # Vector con claves de matemáticas
claves_lenguaje = c('A',	'A',	'B',	'B',	'A',	'A',	'A',	'B',	'A') # Vector con claves de lenguaje
actitudes_lenguaje_post[,7:15] = calificacion(actitudes_lenguaje_post[,7:15], claves_lenguaje)
actitudes_lenguaje_pre = filter(actitudes_pre, substr(`Código`, 1, 1) == "1")
actitudes_lenguaje_post = filter(actitudes_post, substr(`Código`, 1, 1) == "1")
# Calificación
# Total
actitudes_lenguaje_pre$Total_pre = apply(actitudes_lenguaje_pre[,7:15], 1, function(x) sum(x, na.rm= FALSE))
actitudes_lenguaje_post$Total_post = apply(actitudes_lenguaje_post[,7:15], 1, function(x) sum(x, na.rm= FALSE))
## Librerías
# Datos
library(readxl)
library(tidyr)
library(dplyr)
library(googlesheets4)
library(stringr)
# Análsis de datos
library(likert)
library(nortest)
library(effsize)
library(psychometric)
library(ShinyItemAnalysis)
#Graficas
library(ggplot2)
library(gt)
library(DT)
#Funciones propias
source("./Functions/min_max_scaler.R")
source("./Functions/calificacion.R")
# Otros
options(digits=5, scipen = 50)
set.seed(321)
# rmarkdown::render(input="1.0-bapinedam-Primera_aplicacion.Rmd",output_file = "../Pdf/Resultados primera aplicacion.pdf")
# Data
### Autenticación de usuario
gs4_auth()
# pre
### Obtención de los datos
url_pre = "https://docs.google.com/spreadsheets/d/1Ry73ckzruTQxtDnkCSscs16M3cv3u9XgJlcg4sN94BE/edit?usp=sharing"
sheet_names(url_pre)
# post
url_post = "https://docs.google.com/spreadsheets/d/1tFkxbH5N9HMr5qRA-VF4JXh-MAJqW38-iidB4QBuKU4/edit#gid=1877736074"
sheet_names(url_post)
# Pre
actitudes_pre = read_sheet(url_pre, sheet = "Actitudes")
actitudes_pre = actitudes_pre[,1:15]
col_items = paste(rep("Grupo", 9), rep(1:3, each = 3), rep(paste("_", rep(1:3, 3))))
vector = c(colnames(actitudes_pre)[1:6], col_items)
colnames(actitudes_pre) = vector
actitudes_pre = filter(actitudes_pre,
!is.na(`Código`),
!is.na(`Grupo 1 _ 1`),
`Grupo 1 _ 1` %in% c("A", "B", "O", "X"))
dim(actitudes_pre)
actitudes_pre[,7:15] = apply(actitudes_pre[,7:15], 2, function(x) str_to_upper(x))
actitudes_pre[,7:15] = apply(actitudes_pre[,7:15], 2, function(x) {ifelse(x == "B", 1, 0)})
actitudes_post = read_sheet(url_post, sheet = "Actitudes")
actitudes_post = actitudes_post[,1:15]
col_items = paste(rep("Grupo", 9), rep(1:3, each = 3), rep(paste("_", rep(1:3, 3))))
vector = c(colnames(actitudes_post)[1:6], col_items)
colnames(actitudes_post) = vector
actitudes_post[,7:15] = apply(actitudes_post[,7:15], 2, function(x) as.character(x))
actitudes_post = filter(actitudes_post,
!is.na(`Código`),
!is.na(`Grupo 1 _ 1`),
`Grupo 1 _ 1` %in% c("A", "B", "O", "X"))
dim(actitudes_post)
actitudes_post[,7:15] = apply(actitudes_post[,7:15], 2, function(x) str_to_upper(x))
claves_matematicas =  c('B',	'A',	'A',	'A',	'A',	'B',	'A',	'A',	'B') # Vector con claves de matemáticas
claves_lenguaje = c('A',	'A',	'B',	'B',	'A',	'A',	'A',	'B',	'A') # Vector con claves de lenguaje
actitudes_lenguaje_post[,7:15] = calificacion(actitudes_lenguaje_post[,7:15], claves_lenguaje)
actitudes_lenguaje_pre = filter(actitudes_pre, substr(`Código`, 1, 1) == "1")
actitudes_lenguaje_post = filter(actitudes_post, substr(`Código`, 1, 1) == "1")
# Calificación
# Total
actitudes_lenguaje_pre$Total_pre = apply(actitudes_lenguaje_pre[,7:15], 1, function(x) sum(x, na.rm= FALSE))
actitudes_lenguaje_post$Total_post = apply(actitudes_lenguaje_post[,7:15], 1, function(x) sum(x, na.rm= FALSE))
View(actitudes_lenguaje_post)
calificacion(actitudes_lenguaje_post[,7:15], claves_lenguaje)
actitudes_lenguaje_post[,7:15] = calificacion(actitudes_lenguaje_post[,7:15], claves_lenguaje)
View(actitudes_lenguaje_post)
## Librerías
# Datos
library(readxl)
library(tidyr)
library(dplyr)
library(googlesheets4)
library(stringr)
# Análsis de datos
library(likert)
library(nortest)
library(effsize)
library(psychometric)
library(ShinyItemAnalysis)
#Graficas
library(ggplot2)
library(gt)
library(DT)
#Funciones propias
source("./Functions/min_max_scaler.R")
source("./Functions/calificacion.R")
# Otros
options(digits=5, scipen = 50)
set.seed(321)
# rmarkdown::render(input="1.0-bapinedam-Primera_aplicacion.Rmd",output_file = "../Pdf/Resultados primera aplicacion.pdf")
# Data
### Autenticación de usuario
gs4_auth()
# pre
### Obtención de los datos
url_pre = "https://docs.google.com/spreadsheets/d/1Ry73ckzruTQxtDnkCSscs16M3cv3u9XgJlcg4sN94BE/edit?usp=sharing"
sheet_names(url_pre)
# post
url_post = "https://docs.google.com/spreadsheets/d/1tFkxbH5N9HMr5qRA-VF4JXh-MAJqW38-iidB4QBuKU4/edit#gid=1877736074"
sheet_names(url_post)
# Pre
actitudes_pre = read_sheet(url_pre, sheet = "Actitudes")
actitudes_pre = actitudes_pre[,1:15]
col_items = paste(rep("Grupo", 9), rep(1:3, each = 3), rep(paste("_", rep(1:3, 3))))
vector = c(colnames(actitudes_pre)[1:6], col_items)
colnames(actitudes_pre) = vector
actitudes_pre = filter(actitudes_pre,
!is.na(`Código`),
!is.na(`Grupo 1 _ 1`),
`Grupo 1 _ 1` %in% c("A", "B", "O", "X"))
dim(actitudes_pre)
actitudes_pre[,7:15] = apply(actitudes_pre[,7:15], 2, function(x) str_to_upper(x))
actitudes_pre[,7:15] = apply(actitudes_pre[,7:15], 2, function(x) {ifelse(x == "B", 1, 0)})
actitudes_post = read_sheet(url_post, sheet = "Actitudes")
actitudes_post = actitudes_post[,1:15]
col_items = paste(rep("Grupo", 9), rep(1:3, each = 3), rep(paste("_", rep(1:3, 3))))
vector = c(colnames(actitudes_post)[1:6], col_items)
colnames(actitudes_post) = vector
actitudes_post[,7:15] = apply(actitudes_post[,7:15], 2, function(x) as.character(x))
actitudes_post = filter(actitudes_post,
!is.na(`Código`),
!is.na(`Grupo 1 _ 1`),
`Grupo 1 _ 1` %in% c("A", "B", "O", "X"))
actitudes_post[,7:15] = apply(actitudes_post[,7:15], 2, function(x) str_to_upper(x))
claves_matematicas =  c('B',	'A',	'A',	'A',	'A',	'B',	'A',	'A',	'B') # Vector con claves de matemáticas
claves_lenguaje = c('A',	'A',	'B',	'B',	'A',	'A',	'A',	'B',	'A') # Vector con claves de lenguaje
actitudes_lenguaje_post[,7:15] = calificacion(actitudes_lenguaje_post[,7:15], claves_lenguaje)
actitudes_lenguaje_pre = filter(actitudes_pre, substr(`Código`, 1, 1) == "1")
actitudes_lenguaje_post = filter(actitudes_post, substr(`Código`, 1, 1) == "1")
# Calificación
# Total
actitudes_lenguaje_pre$Total_pre = apply(actitudes_lenguaje_pre[,7:15], 1, function(x) sum(x, na.rm= FALSE))
actitudes_lenguaje_post$Total_post = apply(actitudes_lenguaje_post[,7:15], 1, function(x) sum(x, na.rm= FALSE))
## Librerías
# Datos
library(readxl)
library(tidyr)
library(dplyr)
library(googlesheets4)
library(stringr)
# Análsis de datos
library(likert)
library(nortest)
library(effsize)
library(psychometric)
library(ShinyItemAnalysis)
#Graficas
library(ggplot2)
library(gt)
library(DT)
#Funciones propias
source("./Functions/min_max_scaler.R")
source("./Functions/calificacion.R")
# Otros
options(digits=5, scipen = 50)
set.seed(321)
# rmarkdown::render(input="1.0-bapinedam-Primera_aplicacion.Rmd",output_file = "../Pdf/Resultados primera aplicacion.pdf")
# Data
### Autenticación de usuario
gs4_auth()
# pre
### Obtención de los datos
url_pre = "https://docs.google.com/spreadsheets/d/1Ry73ckzruTQxtDnkCSscs16M3cv3u9XgJlcg4sN94BE/edit?usp=sharing"
sheet_names(url_pre)
# post
url_post = "https://docs.google.com/spreadsheets/d/1tFkxbH5N9HMr5qRA-VF4JXh-MAJqW38-iidB4QBuKU4/edit#gid=1877736074"
sheet_names(url_post)
# Pre
actitudes_pre = read_sheet(url_pre, sheet = "Actitudes")
actitudes_pre = actitudes_pre[,1:15]
col_items = paste(rep("Grupo", 9), rep(1:3, each = 3), rep(paste("_", rep(1:3, 3))))
vector = c(colnames(actitudes_pre)[1:6], col_items)
colnames(actitudes_pre) = vector
actitudes_pre = filter(actitudes_pre,
!is.na(`Código`),
!is.na(`Grupo 1 _ 1`),
`Grupo 1 _ 1` %in% c("A", "B", "O", "X"))
dim(actitudes_pre)
actitudes_pre[,7:15] = apply(actitudes_pre[,7:15], 2, function(x) str_to_upper(x))
actitudes_pre[,7:15] = apply(actitudes_pre[,7:15], 2, function(x) {ifelse(x == "B", 1, 0)})
actitudes_post = read_sheet(url_post, sheet = "Actitudes")
actitudes_post = actitudes_post[,1:15]
col_items = paste(rep("Grupo", 9), rep(1:3, each = 3), rep(paste("_", rep(1:3, 3))))
vector = c(colnames(actitudes_post)[1:6], col_items)
colnames(actitudes_post) = vector
actitudes_post[,7:15] = apply(actitudes_post[,7:15], 2, function(x) as.character(x))
actitudes_post = filter(actitudes_post,
!is.na(`Código`),
!is.na(`Grupo 1 _ 1`),
`Grupo 1 _ 1` %in% c("A", "B", "O", "X"))
actitudes_post[,7:15] = apply(actitudes_post[,7:15], 2, function(x) str_to_upper(x))
claves_matematicas =  c('B',	'A',	'A',	'A',	'A',	'B',	'A',	'A',	'B') # Vector con claves de matemáticas
claves_lenguaje = c('A',	'A',	'B',	'B',	'A',	'A',	'A',	'B',	'A') # Vector con claves de lenguaje
actitudes_lenguaje_pre = filter(actitudes_pre, substr(`Código`, 1, 1) == "1")
actitudes_lenguaje_post = filter(actitudes_post, substr(`Código`, 1, 1) == "1")
# Calificación post
actitudes_lenguaje_post[,7:15] = calificacion(actitudes_lenguaje_post[,7:15], claves_lenguaje)
# Calificación
# Total
actitudes_lenguaje_pre$Total_pre = apply(actitudes_lenguaje_pre[,7:15], 1, function(x) sum(x, na.rm= FALSE))
actitudes_lenguaje_post$Total_post = apply(actitudes_lenguaje_post[,7:15], 1, function(x) sum(x, na.rm= FALSE))
# Afectivo
actitudes_lenguaje_pre$Afectivo_pre = apply(actitudes_lenguaje_pre[,c(7, 10, 13)], 1, function(x) sum(x, na.rm= FALSE))
actitudes_lenguaje_post$Afectivo_post = apply(actitudes_lenguaje_post[,c(7, 10, 13)], 1, function(x) sum(x, na.rm= FALSE))
# Cognitivo
actitudes_lenguaje_pre$Cognitivo_pre = apply(actitudes_lenguaje_pre[,c(8, 11, 14)], 1, function(x) sum(x, na.rm= FALSE))
actitudes_lenguaje_post$Cognitivo_post = apply(actitudes_lenguaje_post[,c(8, 11, 14)], 1, function(x) sum(x, na.rm= FALSE))
# Conativo
actitudes_lenguaje_pre$Conativo_pre = apply(actitudes_lenguaje_pre[,c(9, 12, 15)], 1, function(x) sum(x, na.rm= FALSE))
actitudes_lenguaje_post$Conativo_post = apply(actitudes_lenguaje_post[,c(9, 12, 15)], 1, function(x) sum(x, na.rm= FALSE))
# Matriz pre y post para comparación de muestras
pre_post = inner_join(actitudes_lenguaje_post,
dplyr::select(actitudes_lenguaje_pre, c("Código", "Total_pre", "Afectivo_pre",
"Cognitivo_pre", "Conativo_pre")),
by = "Código")
alpha(actitudes_lenguaje_pre[,7:15])
for(i in seq(length(colnames(actitudes_lenguaje_pre[,7:15])))){
x = alpha(actitudes_lenguaje_pre[,7:15][,-i])
print(paste("El índice de confiabilidad cambia a", x, "al eliminar el ítem", colnames(actitudes_lenguaje_pre[,7:15])[i]))
}
alpha(actitudes_lenguaje_post[,7:15])
for(i in seq(length(colnames(actitudes_lenguaje_post[,7:15])))){
x = alpha(actitudes_lenguaje_post[,7:15][,-i])
print(paste("El índice de confiabilidad cambia a", x, "al eliminar el ítem", colnames(actitudes_lenguaje_post[,7:15])[i]))
}
rmarkdown::render(input="1.0-bapinedam-Primera_aplicacion.Rmd",output_file = "../Pdf/Resultados primera aplicacion.pdf")
rmarkdown::render(input="1.0-bapinedam-Primera_aplicacion.Rmd",output_file = "../Pdf/Resultados primera aplicacion.pdf")
rmarkdown::render(input="1.0-bapinedam-Primera_aplicacion.Rmd",output_file = "../Pdf/Resultados primera aplicacion.pdf")
rmarkdown::render(input="1.0-bapinedam-Primera_aplicacion.Rmd",output_file = "../Pdf/Resultados primera aplicacion.pdf")
